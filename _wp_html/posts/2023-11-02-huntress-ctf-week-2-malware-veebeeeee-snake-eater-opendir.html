<!-- wp:heading -->
<h2 class="wp-block-heading">VeeBeeEee</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1637,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-9.17.08e280afam.png?w=1024" alt="" class="wp-image-1637" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>First examine the file contents. </p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1639,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-9.20.58e280afam.png?w=1024" alt="" class="wp-image-1639" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Ooof. That hurts the eyes. If we throw it into CyberChef, with the assistance of some magic (or detailed reading of the challenge), we see that it's VB Script, which can be converted using the Microsoft Script Decoder recipe.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1641,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-9.22.44e280afam.png?w=1024" alt="" class="wp-image-1641" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Copy the output to VS Code.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1643,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-12.55.41e280afpm.png?w=1024" alt="" class="wp-image-1643" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The syntax highlighting shows that all the <em>''''''''''''''''al37ysoeopm'al37ysoeopm</em> entries are just comments, so let's remove them.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1644,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-10.36.01e280afam.png?w=1024" alt="" class="wp-image-1644" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>There also seems to be an abundance of "&amp;" obscuring the code. We'll remove them too.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1646,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-12.44.56e280afpm.png?w=1024" alt="" class="wp-image-1646" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>That's a lot more readable. Looking at the code we see it's going to use PowerShell to create a file C:\Users\Pubic\Documents\July.htm using as input the content from a pastebin URL.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1648,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-10.39.50e280afam.png?w=911" alt="" class="wp-image-1648" /></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">Snake Eater</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1680,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-12-at-7.25.55e280afam.png?w=1024" alt="" class="wp-image-1680" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>We'll detonate snake_eater.exe in our lab environment.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I really enjoyed this challenge as I used my <a href="https://bakerstreetforensics.com/2023/08/10/capturing-malware-evidence-with-detonare/">detonaRE PowerShell script</a> to control the detonation and solve the challenge. Besides firing the malware itself, the script will initiate a pcap capture and monitor the malware process using Process Monitor. The script the converts the ProcMon output to csv for easy analysis.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1681,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-12-at-10.05.52e280afam.png?w=1024" alt="" class="wp-image-1681" /></figure>
<!-- /wp:image -->

<!-- wp:image {"id":1684,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-12-at-10.03.48e280afam.png?w=1024" alt="" class="wp-image-1684" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Scrolling through the csv we find that the application was writing a file to: </p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>~\AppData\Roaming\Mael Horns\flag{hashforflag}</code></pre>
<!-- /wp:code -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">Opendir</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1716,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-13-at-9.01.55e280afam.png?w=1024" alt="" class="wp-image-1716" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Let's get Started</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1717,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-13-at-9.30.06e280afam.png?w=1024" alt="" class="wp-image-1717" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The link brings us to an Open Directory (duh) with lots of scripts and executables, not to mention a number of subdirectories. </p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1784,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-12.41.25e280afpm.png?w=1024" alt="" class="wp-image-1784" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The first thing to do is <strong>grab everything</strong>.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1719,"width":"300px","height":"auto","sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/2lh7z9.jpg?w=500" alt="" class="wp-image-1719" style="width:300px;height:auto" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>Site Sucker</strong> works well for this.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1722,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-12.55.16e280afpm.png?w=657" alt="" class="wp-image-1722" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Once we've captured all the files and subdirectories locally we can search through them en masse. Once again in this CTF, <strong>the_silver_searcher</strong> (<strong>ag</strong>) comes into play.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1723,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-12.59.53e280afpm.png?w=1024" alt="" class="wp-image-1723" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Tucked away in <em><strong>/sir/64_bit_new/oui.txt</strong></em> is the flag.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>Use the tag <a href="https://bakerstreetforensics.com/tag/HuntressCTF/"><strong>#HuntressCTF</strong></a> on BakerStreetForensics.com to see all related posts and solutions for the 2023 Huntress CTF.</p>
<!-- /wp:paragraph -->