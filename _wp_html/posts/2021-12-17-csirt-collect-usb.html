<!-- wp:paragraph -->
<p>CSIRT-Collect USB can be found in the main repository for CSIRT-Collect.  CSIRT-Collect is a PowerShell script to collect memory and (triage) disk forensics for incident response investigations.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":588,"width":96,"height":97,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://bakerstreetforensics.com/wp-content/uploads/2021/12/usb-.png?w=572" alt="" class="wp-image-588" width="96" height="97" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>CSIRT-Collect USB </strong>is designed to run directly from a USB device. While a network deployment certainly supports automation, as an Incident Responder I can think of several examples where that wouldn't be an option:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>An air-gapped manufacturing environment</li><li>Hospital/Medical Environments</li><li>Ransomware incidents when the assets have been detached from the network</li></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Preparation </strong>is the first phase of the Incident Response lifecycle. (PICERL) Once you've tested and/or adapted the collection for your environment, consider prepping a handful of drives and having them pre-deployed to sites where you're likely to need them.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":590,"width":165,"height":223,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://bakerstreetforensics.com/wp-content/uploads/2021/12/20211217_123726000_ios.jpg?w=758" alt="" class="wp-image-590" width="165" height="223" /></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="the-setup"><strong>The Setup</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>First off you're going to need a high-capacity USB device. Larger sized flash drives will work. Personally I'm a fan of Samsung (T series) SSD drives, both for their size and their write speeds during acquisitions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On the root of the USB device:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>A (initially empty) folder named 'Collections'</li><li>KAPE directory from default KAPE installation</li><li>EDD.exe in \KAPE\Modules\bin\EDD (Encrypted Disk Detector)</li><li>CSIRT-Collect_USB.ps1</li><li>MRC.exe (Magnet RAM Capture)</li></ul>
<!-- /wp:list -->

<!-- wp:image {"id":592,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2021/12/setup.png?w=892" alt="" class="wp-image-592" /></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="launch"><strong>Launch</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>To run the script, open an elevated PowerShell prompt and browse to the USB device. Then simply</p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>.\CSIRT-Collect_USB.ps1</code></pre>
<!-- /wp:code -->

<!-- wp:image {"id":594,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2021/12/start.png?w=1003" alt="" class="wp-image-594" /><figcaption>CSIRT-Collect_USB.ps1 starting</figcaption></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="what-it-captures">What it Captures</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The first process the script runs is Magnet RAM Capture. Once the RAM has been captured, the windows build (profile) is captured. The RAM image and the build info are named to reflect the asset hostname being collected.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The next process is the KAPE Triage collection.  Host artifacts are acquired and then assembled as a .vhdx (portable hard disk) image. After the KAPE <em>Targets </em>portion completes, KAPE calls the Encrypted Disk Detector module which checks the local physical drives on a system for TrueCrypt, PGP, VeraCrypt, SafeBoot, or Bitlocker encrypted volumes. This information is saved into the Collections directory, as well as displayed to the responder to identify other volumes that may need to be collected while the system is live.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Lastly, if BitLocker is enabled for the OS drive the script will capture that information as well and back-up the recovery key.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":597,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2021/12/encryption-check.png?w=1024" alt="" class="wp-image-597" /><figcaption>Disk Encryption Check</figcaption></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="collection-contents">Collection Contents</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Inside the Collections folder, a subfolder will be created for each asset collected. The size of the USB device will determine how many collections can be captured before the results need to be offloaded.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <strong>\Collections\%hostname%</strong> directory will include:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>Console log capturing all KAPE targets activity</li><li>.vhdx of the host artifacts</li><li>collection complete date/time .txt</li><li>Memory acquisition .raw</li><li>Windows profile (build information) .txt</li></ul>
<!-- /wp:list -->

<!-- wp:image {"id":599,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2021/12/collection-contents.png?w=1024" alt="" class="wp-image-599" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>In the<strong> \Collections\%hostname%\Decrypt</strong> folder you will find</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>console log for KAPE modules (EDD)</li><li>recovery key for BitLocker (C) volume .txt</li><li><em><strong>Live Response</strong></em> directory with the output of EDD .txt</li></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>###</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>https://github.com/dwmetz/CSIRT-Collect</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>###</p>
<!-- /wp:paragraph -->