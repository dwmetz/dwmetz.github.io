<!-- wp:heading -->
<h2 class="wp-block-heading">Wimble</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1588,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-10-at-9.02.04e280afam.png?w=814" alt="" class="wp-image-1588" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Once the file was downloaded and extracted from the zip I ran the file command on it.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1591,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-10-at-10.38.46e280afam.png?w=899" alt="" class="wp-image-1591" /></figure>
<!-- /wp:image -->

<!-- wp:image {"id":1592,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-10-at-9.06.06e280afam.png?w=684" alt="" class="wp-image-1592" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>OK so we'll be doing the analysis for this one on a Windows box to start. <br><br>Move the file to windows and rename to Fetch.wim</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1594,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-10-at-9.08.33e280afam.png?w=76" alt="" class="wp-image-1594" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Open the .wim with 7zip explorer</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1596,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-10-at-10.03.45e280afam.png?w=1024" alt="" class="wp-image-1596" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Within the zip file we see a plethora of Prefetch (.pf) files, but among them we there is a fetch.zip</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When we extract the contents of the zip file we have another directory of Prefetch files.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1597,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-10-at-10.24.49e280afam.png?w=1024" alt="" class="wp-image-1597" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>I extracted the .pf files to a folder. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I used Magnet AXIOM to process the prefetch files. Based on our scenario, I have keywords set for <em>Huntress</em>, <em>ctf</em>, and <em>flag</em>.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1599,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-10-at-10.16.57e280afam.png?w=1024" alt="" class="wp-image-1599" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><em>That was easy.</em></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">Opposable Thumbs</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1728,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-16-at-7.07.44e280afam.png?w=1024" alt="" class="wp-image-1728" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>I know for a fact that Axiom can process thumbnail caches.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1729,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-16-at-7.08.47e280afam.png?w=1024" alt="" class="wp-image-1729" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>And BAM! there's the flag.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">Tragedy Redux</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1790,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/question.png?w=965" alt="" class="wp-image-1790" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>First things first, let's get an idea of what kind of file we're dealing with. Hmm. It shows as a zip archive. When the file is unzipped we see the structure below.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1792,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/steps1-2.png?w=1024" alt="" class="wp-image-1792" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Looking at the structure, as seasoned analyst may identify that the tragedy_redux file is in fact a word document. Which will bring up another method in a minute.  But before that let's take a look at the vbaProject.bin file with olevba.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1794,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/steps3olevba.png?w=1024" alt="" class="wp-image-1794" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>There's a macro file with some curious fruit and vegetable related functions. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you realized at the beginning this was a word doc file, you could append the file extension .docm to the file.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When opening the file in Word, there is a prompt to enable macros.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1795,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/macro_warning.png?w=444" alt="" class="wp-image-1795" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Once the document is open you see a document containing the definition of Tragedy.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1797,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-23-at-4.04.59e280afpm.png?w=670" alt="" class="wp-image-1797" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>From there we can go to Tools &gt; Macros &gt; Edit... we can get to the same vbs content we did with olevba.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1799,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-23-at-4.07.01e280afpm.png?w=1024" alt="" class="wp-image-1799" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The next step was to convert the vbs into something actionable. I struggled on this one, but one of my teammates was successful in converting the vbs to Python.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This code interprets the numeric values in <code>longstring</code> (Apples), as decimal representations of ASCII values, subtracts 17 from each value, and prints the corresponding characters. The characters are printed one by one without newlines, forming a string of characters as the output.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1802,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/steps4-.png?w=1024" alt="" class="wp-image-1802" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>When we run the Python script we get back:</p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>powershell -enc JGZsYWc9ImZsYWd7NjNkY2M4MmMzMDE5Nzc2OGY0ZDQ1OGRhMTJmNjE4YmN9Ig==</code></pre>
<!-- /wp:code -->

<!-- wp:paragraph -->
<p>Now we can echo the value to base64 decrypt and get our final flag value.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>Use the tag <a href="https://bakerstreetforensics.com/tag/HuntressCTF/"><strong>#HuntressCTF</strong></a> on BakerStreetForensics.com to see all related posts and solutions for the 2023 Huntress CTF.</p>
<!-- /wp:paragraph -->