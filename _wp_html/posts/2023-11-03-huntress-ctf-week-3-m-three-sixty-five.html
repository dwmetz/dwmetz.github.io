<!-- wp:image {"id":1751,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-2.26.39e280afpm.png?w=1024" alt="" class="wp-image-1751" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>This is a multipart challenge. All the flags can be found within the live Microsoft 365 instance that we'll ssh into.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1754,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-2.28.26e280afpm.png?w=1024" alt="" class="wp-image-1754" /></figure>
<!-- /wp:image -->

<!-- wp:image {"id":1756,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-2.31.32e280afpm.png?w=1024" alt="" class="wp-image-1756" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The clue is <em>street address. </em>I'm not too fluent in the capabilities of AADInternals, so the first thing I do is head over to the <a href="https://aadinternals.com/aadinternals/" target="_blank" rel="noreferrer noopener">documentation</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If I do a search on 'street' I see that it's part of an Output example for <strong>Get-AADintTenantDetails</strong></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1776,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-2.57.31e280afpm.png?w=922" alt="" class="wp-image-1776" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Ok, let's give that command a go.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1758,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-16-at-1.36.17e280afpm.png?w=1024" alt="" class="wp-image-1758" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>And there's the flag under the street value.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1760,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-2.37.52e280afpm.png?w=1024" alt="" class="wp-image-1760" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>For the next one, It not so subtly says that Conditional Access Policies will be part of this, so again we reference the docs. <strong>Get-AADIntConditionalAccessPolicies</strong> seems like a good candidate.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1762,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-16-at-1.37.48e280afpm.png?w=1024" alt="" class="wp-image-1762" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Two for two.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1764,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-2.41.53e280afpm.png?w=1024" alt="" class="wp-image-1764" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Microsoft Teams will be our focus on the third one. There's dozens of Teams commands available within AADInternals. If we focus on <em>message</em>, that will get us to <strong>Get-AADIntTeamsMessages</strong>.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1768,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-16-at-1.39.45e280afpm.png?w=1024" alt="" class="wp-image-1768" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Having the documentation for the syntax really helped on this one.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1766,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-2.46.07e280afpm.png?w=1024" alt="" class="wp-image-1766" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>And for the last one, no there isn't a Get-AADIntPresident command.  That would be too easy. How about a command that will show us all the users?</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1770,"width":"840px","height":"auto","sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-16-at-1.55.00e280afpm.png?w=546" alt="" class="wp-image-1770" style="width:840px;height:auto" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Scrolling up through the output, we find that the President (PattiF), has a <em>flag</em> in the telephone number field.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1772,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-16-at-1.54.30e280afpm.png?w=1024" alt="" class="wp-image-1772" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>4 out of 4.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>Use the tag <a href="https://bakerstreetforensics.com/tag/HuntressCTF/"><strong>#HuntressCTF</strong></a> on BakerStreetForensics.com to see all related posts and solutions for the 2023 Huntress CTF.</p>
<!-- /wp:paragraph -->