<!-- wp:paragraph -->
<p>I‚Äôm excited to share with you a new script I‚Äôve written, Magnet RESPONSE PowerShell.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://www.magnetforensics.com/resources/magnet-response/">Magnet RESPONSE</a> is a free tool from Magnet Forensics that makes it easy for investigators as well as non-technical operators to collect triage collections quickly and consistently.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Released initially as a GUI tool for law-enforcement investigators, it‚Äôs a single executable that requires no installation. The available command line syntax also makes it very flexible for enterprise use.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>So what do I do when there‚Äôs a command line interface available, I PowerShell the hell out of it.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you‚Äôve been following my <a href="https://github.com/dwmetz/CyberPipe">CyberPipe</a> project, you‚Äôll definitely want to check this one out.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">MagnetRESPONSEPowerShell.ps1</h3>
<!-- /wp:heading -->

<!-- wp:image {"id":1327,"linkDestination":"custom"} -->
<figure class="wp-block-image"><a href="https://github.com/MagnetForensics/Magnet-RESPONSE-PowerShell/blob/main/screenshot.png" target="_blank" rel="noreferrer noopener"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/09/image.png" alt="" class="wp-image-1327" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading">Functions:</h5>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>üíª Capture specified triage artifacts using profiles with Magnet RESPONSE,</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>üêè Capture a memory image with DumpIt for Windows or Magnet RAM Capture,</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>üíæ Save all artifacts, output, and audit logs to network drive.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>ü™ü Supports x86, x64 and ARM64 versions of Windows</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading {"level":5} -->
<h5 class="wp-block-heading">Prerequisites:</h5>
<!-- /wp:heading -->

<!-- wp:quote -->
<blockquote class="wp-block-quote"><!-- wp:list -->
<ul><!-- wp:list-item -->
<li><a href="https://www.magnetforensics.com/resources/magnet-response/">Magnet RESPONSE</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Web server where you can host MagnetRESPONSE.zip that‚Äôs accessible to endpoints.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>File server repository to save the file collections to.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list --></blockquote>
<!-- /wp:quote -->

<!-- wp:paragraph -->
<p><strong>Please note this is not a Magnet supported product. This script is open source. If you have comments, updates, or suggestions - please do so here or on GitHub via discussion or pull request.</strong></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>There are two areas of the script for you to customize.</p>
<!-- /wp:paragraph -->

<!-- wp:quote -->
<blockquote class="wp-block-quote"><!-- wp:list -->
<ul><!-- wp:list-item -->
<li>The&nbsp;<em><strong>Variable Setup</strong></em>&nbsp;contains the case identification, file server and web server locations.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>The second section,&nbsp;<em><strong>Collection Profiles</strong></em>, define which artifact groups you want to collect. You can see all the options available in the&nbsp;<a href="https://github.com/MagnetForensics/Magnet-RESPONSE-PowerShell/blob/main/Magnet_RESPONSE_CLI_Guide.pdf">Magnet RESPONSE CLI Guide</a>.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list --></blockquote>
<!-- /wp:quote -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">VARIABLE SETUP</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><code>$caseID = "demo-161" # no spaces</code></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>$outputpath = "\\Server\Share" # Update to reflect output destination.</code></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>$server = "192.168.4.187" # "192.168.1.10" resolves to http://192.168.1.10/MagnetRESPONSE.zip</code></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">COLLECTION PROFILES</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Within the script we need to have at least one set of collection arguments defined. In this case I‚Äôve built multiple profiles, which are simply un-commented to mark the profile as active. You only want to have one profile enabled at a time. You can design your own collection profiles using any of the available CLI options, just follow the format below.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>#### Extended Process Capture</code></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>$profileName = "EXTENDED PROCESS CAPTURE"</code></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>$arguments = "/capturevolatile /captureextendedprocessinfo /saveprocfiles"</code></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Execution</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Once your environment and collection variables are defined, go ahead and run the script on your endpoints. Every host that executes the script will download RESPONSE from the web server, run the specified collection profile, and then save the output to the file server.  All data defined in the collection profile will be collected and organized by case name, hostname and timestamp of collection in the central location. The returned files can be examined manually, using open source tools, or products like Magnet AXIOM Cyber.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you‚Äôd like to learn more about the script, and how I integrated it with AXIOM Cyber and Magnet AUTOMATE, you can <strong>register for my webcast, <a rel="noreferrer noopener" href="https://www.magnetforensics.com/resources/responding-at-scale-with-magnet-response/" target="_blank">Responding at Scale with Magnet RESPONSE.</a></strong> I hope to see you there. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>You can download the script at <a href="https://github.com/MagnetForensics/Magnet-RESPONSE-PowerShell">https://github.com/MagnetForensics/Magnet-RESPONSE-PowerShell</a></p>
<!-- /wp:paragraph -->