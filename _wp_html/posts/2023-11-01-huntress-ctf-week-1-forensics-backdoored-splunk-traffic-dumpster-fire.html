<!-- wp:heading -->
<h2 class="wp-block-heading">Backdoored Splunk</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1453,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-07-at-9.03.22e280afam.png?w=1024" alt="" class="wp-image-1453" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Hit Start. </p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1455,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-09-at-11.03.22e280afam.png?w=1024" alt="" class="wp-image-1455" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>So we've got a url and a specific port. Firefox web browser yields...</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1461,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-09-at-11.07.22e280afam.png?w=1024" alt="" class="wp-image-1461" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>So we need an Authorization header. ðŸ¤”</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Time to look at the provided files. It looks to be the export of a Splunk application. </p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1462,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-09-at-11.13.43e280afam.png?w=976" alt="" class="wp-image-1462" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Time to download an eval copy of Splunk and... pause. There's probably a simpler way to attack this.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/ggreer/the_silver_searcher">The Silver Searcher</a> is a command line tool I picked up during the CTF and I love it. It's like Grep on PCP.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Once installed, the base command is ag, followed by what you're searching for, and where. So let's do a quick search for Authorization on all the contents of this directory.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1464,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-09-at-11.19.44e280afam.png?w=1024" alt="" class="wp-image-1464" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>That looks interesting. A clue? One of the PowerShell scripts has <strong><em>Authorization</em></strong> and what looks to be Base64 code.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1466,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-07-at-3.36.59e280afpm.png?w=1024" alt="" class="wp-image-1466" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>We also see a comment about the $PORT being dynamic based on the Start button. Decoding the string in CyberChef...</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1467,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-07-at-3.37.53e280afpm.png?w=1024" alt="" class="wp-image-1467" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>At this point we have all the pieces, we just need to put them together. I started to look at different ways to pass an Authorization header to a web server.  There's proxy tools galore. And then there's the basic's like curl. After a bit of brushing up on my syntax I had: </p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>curl -H "Authorization: Basic &#091;longStringFromThePowershell]" http://site:$PORT</code></pre>
<!-- /wp:code -->

<!-- wp:image {"id":1469,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-07-at-3.36.00e280afpm.png?w=1024" alt="" class="wp-image-1469" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Yay what looks like more Base64. Once more with our Chef's hat and...</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1472,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-07-at-3.38.37e280afpm-1.png?w=1024" alt="" class="wp-image-1472" /></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">Traffic</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1477,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-05-at-10.51.42e280afam.png?w=926" alt="" class="wp-image-1477" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><a href="https://github.com/activecm/rita">rita</a> was a tool I hadn't used before but it was very easy to use. I installed it on my REMnux box and then ran it against the dataset.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1479,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-05-at-9.00.44e280afam.png?w=1000" alt="" class="wp-image-1479" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>I then used the command to generate an html report.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1481,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-05-at-10.51.07e280afam.png?w=696" alt="" class="wp-image-1481" /></figure>
<!-- /wp:image -->

<!-- wp:image {"id":1483,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-09-at-12.00.07e280afpm.png?w=1024" alt="" class="wp-image-1483" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Looking through the DNS requests there's something sketchy indeed.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1484,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-05-at-10.50.28e280afam.png?w=703" alt="" class="wp-image-1484" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Let's go take a look at that.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1486,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-05-at-10.52.54e280afam.png?w=1024" alt="" class="wp-image-1486" /></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">Dumpster Fire</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1489,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-09-at-12.08.35e280afpm.png?w=1024" alt="" class="wp-image-1489" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Let's start with the_silver_searcher again and see if we have any luck with "Password".</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1493,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-08-at-12.27.45e280afpm.png?w=581" alt="" class="wp-image-1493" /></figure>
<!-- /wp:image -->

<!-- wp:image {"id":1491,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-08-at-12.26.51e280afpm.png?w=1024" alt="" class="wp-image-1491" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>There's a number of hits including references to an <em><strong>encryptedUsername</strong></em> and <em><strong>encryptedPassword</strong></em> in the logins.json file. So we've got some encrypted Firefox user passwords. If only there were a utility that could decrypt those. Enter <a href="https://github.com/lclevy/firepwd#firepwdpy">firepwd.py</a>, an open source tool to decrypt Mozilla protected passwords.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Run the script in Python and point it to the directory for the user profile (where the logins.json file is).</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1496,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-09-at-12.25.09e280afpm.png?w=1024" alt="" class="wp-image-1496" /></figure>
<!-- /wp:image -->

<!-- wp:image {"id":1497,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-08-at-12.48.26e280afpm.png?w=1024" alt="" class="wp-image-1497" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>That's a pretty LEET password ;)</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>Use the tag <a href="https://bakerstreetforensics.com/tag/HuntressCTF/"><strong>#HuntressCTF</strong></a> on BakerStreetForensics.com to see all related posts and solutions  for the 2023 Huntress CTF.</p>
<!-- /wp:paragraph -->