<!-- wp:heading -->
<h2 class="wp-block-heading">MFAtigue</h2>
<!-- /wp:heading -->

<!-- wp:image {"id":1850,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-9.14.07e280afam.png?w=1024" alt="" class="wp-image-1850" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>For any of these challenges where there's a download and an online component, I'll usually start with the files.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1853,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.18.10e280afam.png?w=207" alt="" class="wp-image-1853" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>OK. So how can we get a password if we have access to the ntds.dit and the SYSTEM registry hive?</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1855,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.19.20e280afam.png?w=1024" alt="" class="wp-image-1855" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The <a href="https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration" target="_blank" rel="noreferrer noopener">iredteam.com</a> article looks like a good place to start.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1857,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.30.53e280afam.png?w=1024" alt="" class="wp-image-1857" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>There's a reference to dumping hashes using <a href="https://github.com/fortra/impacket" target="_blank" rel="noreferrer noopener">impacket</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I don't have the SECURITY hive, but I do have the ntds.dit and the SYSTEM hive.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1860,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.12.37e280afam.png?w=1024" alt="" class="wp-image-1860" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>From here we'll copy out all the hashes for user accounts. The accounts ending with $ are computer accounts so we won't bother with those.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1861,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.13.12e280afam.png?w=885" alt="" class="wp-image-1861" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>With the hashes isolated in a text file, we can run hashcat on the hashes using the <strong>rockyou</strong> wordlist.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1863,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.07.12e280afam.png?w=1024" alt="" class="wp-image-1863" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>...output continues...</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1865,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.07.59e280afam.png?w=1024" alt="" class="wp-image-1865" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>We've got a match on the hash ending ..cadab42a.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Referencing that against our account information, we see that found hash is the password for JILLIAN_DOTSON.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1867,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-9.56.03e280afam.png?w=985" alt="" class="wp-image-1867" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Now for the url in the challenge. It brings us to a Microsoft sign-in page. We'll use the account huntressctf\JILLIAN_DOTSON</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1869,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.15.21e280afam.png?w=1024" alt="" class="wp-image-1869" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>And the cracked password of katlyn99...</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1871,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.15.43e280afam.png?w=1024" alt="" class="wp-image-1871" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Oh but wait. The account has MFA?!!</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1873,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.15.56e280afam.png?w=1024" alt="" class="wp-image-1873" /></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Hit the <strong>Send Push Notification</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Then <strong>again</strong>,</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>And <strong>again</strong>...</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>After a mildly obnoxious number of repeated attempts....</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":1876,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-27-at-10.16.19e280afam.png?w=1024" alt="" class="wp-image-1876" /></figure>
<!-- /wp:image -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity" />
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p>Use the tag <a href="https://bakerstreetforensics.com/tag/HuntressCTF/"><strong>#HuntressCTF</strong></a> on BakerStreetForensics.com to see all related posts and solutions for the 2023 Huntress CTF.</p>
<!-- /wp:paragraph -->