<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Huntress CTF: Week 2 - Malware: VeeBeeEee, Snake Eater, Opendir | BakerStreetForensics</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Huntress CTF: Week 2 - Malware: VeeBeeEee, Snake Eater, Opendir" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="None" />
<meta property="og:description" content="None" />
<link rel="canonical" href="http://localhost:4000/http:/bakerstreetforensics.com/2023/11/02/huntress-ctf-week-2-malware-veebeeeee-snake-eater-opendir/" />
<meta property="og:url" content="http://localhost:4000/http:/bakerstreetforensics.com/2023/11/02/huntress-ctf-week-2-malware-veebeeeee-snake-eater-opendir/" />
<meta property="og:site_name" content="BakerStreetForensics" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-11-02T13:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Huntress CTF: Week 2 - Malware: VeeBeeEee, Snake Eater, Opendir" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-10-22T07:17:11-04:00","datePublished":"2023-11-02T13:00:00-04:00","description":"None","headline":"Huntress CTF: Week 2 - Malware: VeeBeeEee, Snake Eater, Opendir","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/http:/bakerstreetforensics.com/2023/11/02/huntress-ctf-week-2-malware-veebeeeee-snake-eater-opendir/"},"url":"http://localhost:4000/http:/bakerstreetforensics.com/2023/11/02/huntress-ctf-week-2-malware-veebeeeee-snake-eater-opendir/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="BakerStreetForensics" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">BakerStreetForensics</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Huntress CTF: Week 2 - Malware: VeeBeeEee, Snake Eater, Opendir</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-11-02T13:00:00-04:00" itemprop="datePublished">Nov 2, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="veebeeeee">VeeBeeEee</h2>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-9.17.08e280afam.png?w=1024" alt="" /></p>

<p>First examine the file contents.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-9.20.58e280afam.png?w=1024" alt="" /></p>

<p>Ooof. That hurts the eyes. If we throw it into CyberChef, with the assistance of some magic (or detailed reading of the challenge), we see that it’s VB Script, which can be converted using the Microsoft Script Decoder recipe.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-9.22.44e280afam.png?w=1024" alt="" /></p>

<p>Copy the output to VS Code.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-12.55.41e280afpm.png?w=1024" alt="" /></p>

<p>The syntax highlighting shows that all the <em>’’’’’’’’’’’’’’'’al37ysoeopm’al37ysoeopm</em> entries are just comments, so let’s remove them.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-10.36.01e280afam.png?w=1024" alt="" /></p>

<p>There also seems to be an abundance of “&amp;” obscuring the code. We’ll remove them too.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-12.44.56e280afpm.png?w=1024" alt="" /></p>

<p>That’s a lot more readable. Looking at the code we see it’s going to use PowerShell to create a file C:\Users\Pubic\Documents\July.htm using as input the content from a pastebin URL.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-10.39.50e280afam.png?w=911" alt="" /></p>

<hr />

<h2 id="snake-eater">Snake Eater</h2>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-12-at-7.25.55e280afam.png?w=1024" alt="" /></p>

<p>We’ll detonate snake_eater.exe in our lab environment.</p>

<p>I really enjoyed this challenge as I used my <a href="https://bakerstreetforensics.com/2023/08/10/capturing-malware-evidence-with-detonare/">detonaRE PowerShell script</a> to control the detonation and solve the challenge. Besides firing the malware itself, the script will initiate a pcap capture and monitor the malware process using Process Monitor. The script the converts the ProcMon output to csv for easy analysis.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-12-at-10.05.52e280afam.png?w=1024" alt="" /> <img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-12-at-10.03.48e280afam.png?w=1024" alt="" /></p>

<p>Scrolling through the csv we find that the application was writing a file to:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~\AppData\Roaming\Mael Horns\flag{hashforflag}
</code></pre></div></div>

<hr />

<h2 id="opendir">Opendir</h2>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-13-at-9.01.55e280afam.png?w=1024" alt="" /></p>

<p>Let’s get Started</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-13-at-9.30.06e280afam.png?w=1024" alt="" /></p>

<p>The link brings us to an Open Directory (duh) with lots of scripts and executables, not to mention a number of subdirectories.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-12.41.25e280afpm.png?w=1024" alt="" /></p>

<p>The first thing to do is <strong>grab everything</strong>.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/2lh7z9.jpg?w=500" alt="" /></p>

<p><strong>Site Sucker</strong> works well for this.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-12.55.16e280afpm.png?w=657" alt="" /></p>

<p>Once we’ve captured all the files and subdirectories locally we can search through them en masse. Once again in this CTF, <strong>the_silver_searcher</strong> (<strong>ag</strong>) comes into play.</p>

<p><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-12.59.53e280afpm.png?w=1024" alt="" /></p>

<p>Tucked away in <em><strong>/sir/64_bit_new/oui.txt</strong></em> is the flag.</p>

<hr />

<p>Use the tag <a href="https://bakerstreetforensics.com/tag/HuntressCTF/"><strong>#HuntressCTF</strong></a> on BakerStreetForensics.com to see all related posts and solutions for the 2023 Huntress CTF.</p>

  </div><a class="u-url" href="/http:/bakerstreetforensics.com/2023/11/02/huntress-ctf-week-2-malware-veebeeeee-snake-eater-opendir/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">BakerStreetForensics</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">BakerStreetForensics</li><li><a class="u-email" href="mailto:dwmetz@gmail.com">dwmetz@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/dwmetz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">dwmetz</span></a></li><li><a href="https://www.twitter.com/dwmetz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">dwmetz</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Where Irregulars Are Part of the Game</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
