<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Magnet RESPONSE PowerShell | BakerStreetForensics</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Magnet RESPONSE PowerShell" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="None" />
<meta property="og:description" content="None" />
<link rel="canonical" href="http://localhost:4000/http:/bakerstreetforensics.com/2023/09/18/magnet-response-powershell/" />
<meta property="og:url" content="http://localhost:4000/http:/bakerstreetforensics.com/2023/09/18/magnet-response-powershell/" />
<meta property="og:site_name" content="BakerStreetForensics" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-09-18T16:53:13-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Magnet RESPONSE PowerShell" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-09-19T07:55:35-04:00","datePublished":"2023-09-18T16:53:13-04:00","description":"None","headline":"Magnet RESPONSE PowerShell","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/http:/bakerstreetforensics.com/2023/09/18/magnet-response-powershell/"},"url":"http://localhost:4000/http:/bakerstreetforensics.com/2023/09/18/magnet-response-powershell/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="BakerStreetForensics" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">BakerStreetForensics</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Magnet RESPONSE PowerShell</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-09-18T16:53:13-04:00" itemprop="datePublished">Sep 18, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>I‚Äôm excited to share with you a new script I‚Äôve written, Magnet RESPONSE PowerShell.</p>

<p><a href="https://www.magnetforensics.com/resources/magnet-response/">Magnet RESPONSE</a> is a free tool from Magnet Forensics that makes it easy for investigators as well as non-technical operators to collect triage collections quickly and consistently.</p>

<p>Released initially as a GUI tool for law-enforcement investigators, it‚Äôs a single executable that requires no installation. The available command line syntax also makes it very flexible for enterprise use.</p>

<p>So what do I do when there‚Äôs a command line interface available, I PowerShell the hell out of it.</p>

<p>If you‚Äôve been following my <a href="https://github.com/dwmetz/CyberPipe">CyberPipe</a> project, you‚Äôll definitely want to check this one out.</p>

<h3 id="magnetresponsepowershellps1">MagnetRESPONSEPowerShell.ps1</h3>

<p><a href="https://github.com/MagnetForensics/Magnet-RESPONSE-PowerShell/blob/main/screenshot.png"><img src="https://bakerstreetforensics.com/wp-content/uploads/2023/09/image.png" alt="" /></a></p>

<h5 id="functions">Functions:</h5>

<ul>
  <li>üíª Capture specified triage artifacts using profiles with Magnet RESPONSE,</li>
  <li>üêè Capture a memory image with DumpIt for Windows or Magnet RAM Capture,</li>
  <li>üíæ Save all artifacts, output, and audit logs to network drive.</li>
  <li>ü™ü Supports x86, x64 and ARM64 versions of Windows</li>
</ul>

<h5 id="prerequisites">Prerequisites:</h5>

<blockquote>
  <ul>
    <li><a href="https://www.magnetforensics.com/resources/magnet-response/">Magnet RESPONSE</a></li>
    <li>Web server where you can host MagnetRESPONSE.zip that‚Äôs accessible to endpoints.</li>
    <li>File server repository to save the file collections to.</li>
  </ul>

</blockquote>

<p><strong>Please note this is not a Magnet supported product. This script is open source. If you have comments, updates, or suggestions - please do so here or on GitHub via discussion or pull request.</strong></p>

<hr />

<p>There are two areas of the script for you to customize.</p>

<blockquote>
  <ul>
    <li>The¬†<em><strong>Variable Setup</strong></em> ¬†contains the case identification, file server and web server locations.</li>
    <li>The second section,¬†<em><strong>Collection Profiles</strong></em> , define which artifact groups you want to collect. You can see all the options available in the¬†<a href="https://github.com/MagnetForensics/Magnet-RESPONSE-PowerShell/blob/main/Magnet_RESPONSE_CLI_Guide.pdf">Magnet RESPONSE CLI Guide</a>.</li>
  </ul>

</blockquote>

<h3 id="variable-setup">VARIABLE SETUP</h3>

<p><code class="language-plaintext highlighter-rouge">$caseID = "demo-161" # no spaces</code></p>

<p><code class="language-plaintext highlighter-rouge">$outputpath = "\\Server\Share" # Update to reflect output destination.</code></p>

<p><code class="language-plaintext highlighter-rouge">$server = "192.168.4.187" # "192.168.1.10" resolves to http://192.168.1.10/MagnetRESPONSE.zip</code></p>

<h3 id="collection-profiles">COLLECTION PROFILES</h3>

<p>Within the script we need to have at least one set of collection arguments defined. In this case I‚Äôve built multiple profiles, which are simply un-commented to mark the profile as active. You only want to have one profile enabled at a time. You can design your own collection profiles using any of the available CLI options, just follow the format below.</p>

<p><code class="language-plaintext highlighter-rouge">#### Extended Process Capture</code></p>

<p><code class="language-plaintext highlighter-rouge">$profileName = "EXTENDED PROCESS CAPTURE"</code></p>

<p><code class="language-plaintext highlighter-rouge">$arguments = "/capturevolatile /captureextendedprocessinfo /saveprocfiles"</code></p>

<h3 id="execution">Execution</h3>

<p>Once your environment and collection variables are defined, go ahead and run the script on your endpoints. Every host that executes the script will download RESPONSE from the web server, run the specified collection profile, and then save the output to the file server. All data defined in the collection profile will be collected and organized by case name, hostname and timestamp of collection in the central location. The returned files can be examined manually, using open source tools, or products like Magnet AXIOM Cyber.</p>

<p>If you‚Äôd like to learn more about the script, and how I integrated it with AXIOM Cyber and Magnet AUTOMATE, you can <strong>register for my webcast,<a href="https://www.magnetforensics.com/resources/responding-at-scale-with-magnet-response/">Responding at Scale with Magnet RESPONSE.</a></strong> I hope to see you there.</p>

<p>You can download the script at <a href="https://github.com/MagnetForensics/Magnet-RESPONSE-PowerShell">https://github.com/MagnetForensics/Magnet-RESPONSE-PowerShell</a></p>

  </div><a class="u-url" href="/http:/bakerstreetforensics.com/2023/09/18/magnet-response-powershell/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">BakerStreetForensics</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">BakerStreetForensics</li><li><a class="u-email" href="mailto:dwmetz@gmail.com">dwmetz@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/dwmetz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">dwmetz</span></a></li><li><a href="https://www.twitter.com/dwmetz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">dwmetz</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Where Irregulars Are Part of the Game</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
