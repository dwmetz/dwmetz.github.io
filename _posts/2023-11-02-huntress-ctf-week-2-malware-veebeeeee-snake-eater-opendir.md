---
layout: post
permalink: http://bakerstreetforensics.com/2023/11/02/huntress-ctf-week-2-malware-veebeeeee-snake-eater-opendir/
title: 'Huntress CTF: Week 2 - Malware: VeeBeeEee, Snake Eater, Opendir'
description: None
date: 2023-11-02 17:00:00 -0000
last_modified_at: 2023-10-22 11:17:11 -0000
publish: true
pin: false
categories:
- CTF
- DFIR
tags:
- detonaRE
- Malware
- PowerShell
- ProcMon
- the_silver_searcher
- vbs
---
## VeeBeeEee

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-9.17.08e280afam.png?w=1024)

First examine the file contents. 

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-9.20.58e280afam.png?w=1024)

Ooof. That hurts the eyes. If we throw it into CyberChef, with the assistance of some magic (or detailed reading of the challenge), we see that it's VB Script, which can be converted using the Microsoft Script Decoder recipe.

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-9.22.44e280afam.png?w=1024)

Copy the output to VS Code.

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-12.55.41e280afpm.png?w=1024)

The syntax highlighting shows that all the _''''''''''''''''al37ysoeopm'al37ysoeopm_ entries are just comments, so let's remove them.

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-10.36.01e280afam.png?w=1024)

There also seems to be an abundance of "&" obscuring the code. We'll remove them too.

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-12.44.56e280afpm.png?w=1024)

That's a lot more readable. Looking at the code we see it's going to use PowerShell to create a file C:\Users\Pubic\Documents\July.htm using as input the content from a pastebin URL.

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-11-at-10.39.50e280afam.png?w=911)

* * *

## Snake Eater

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-12-at-7.25.55e280afam.png?w=1024)

We'll detonate snake_eater.exe in our lab environment.

I really enjoyed this challenge as I used my [detonaRE PowerShell script](https://bakerstreetforensics.com/2023/08/10/capturing-malware-evidence-with-detonare/) to control the detonation and solve the challenge. Besides firing the malware itself, the script will initiate a pcap capture and monitor the malware process using Process Monitor. The script the converts the ProcMon output to csv for easy analysis.

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-12-at-10.05.52e280afam.png?w=1024) ![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-12-at-10.03.48e280afam.png?w=1024)

Scrolling through the csv we find that the application was writing a file to: 
    
    
    ~\AppData\Roaming\Mael Horns\flag{hashforflag}

* * *

## Opendir

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-13-at-9.01.55e280afam.png?w=1024)

Let's get Started

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-13-at-9.30.06e280afam.png?w=1024)

The link brings us to an Open Directory (duh) with lots of scripts and executables, not to mention a number of subdirectories. 

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-12.41.25e280afpm.png?w=1024)

The first thing to do is **grab everything**.

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/2lh7z9.jpg?w=500)

**Site Sucker** works well for this.

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-12.55.16e280afpm.png?w=657)

Once we've captured all the files and subdirectories locally we can search through them en masse. Once again in this CTF, **the_silver_searcher** (**ag**) comes into play.

![](https://bakerstreetforensics.com/wp-content/uploads/2023/10/screenshot-2023-10-17-at-12.59.53e280afpm.png?w=1024)

Tucked away in _**/sir/64_bit_new/oui.txt**_ is the flag.

* * *

Use the tag [**#HuntressCTF**](https://bakerstreetforensics.com/tag/HuntressCTF/) on BakerStreetForensics.com to see all related posts and solutions for the 2023 Huntress CTF.
